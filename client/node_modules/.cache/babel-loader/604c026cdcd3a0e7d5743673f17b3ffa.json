{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bowserhsu/Documents/React/eitri-site-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/bowserhsu/Documents/React/eitri-site-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/bowserhsu/Documents/React/eitri-site-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/bowserhsu/Documents/React/eitri-site-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/bowserhsu/Documents/React/eitri-site-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/bowserhsu/Documents/React/eitri-site-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/bowserhsu/Documents/React/eitri-site-journal/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{addImage,imgurImage}from'../../services/apiCalls';import ToggleSwitch from'./ToggleSwitch';var IMGUR_BUTTON='Upload Using Imgur Or Image URL';var IMGUR_LOADING='Uploading...';var AddImage=/*#__PURE__*/function(_Component){_inherits(AddImage,_Component);var _super=_createSuper(AddImage);function AddImage(props){var _this;_classCallCheck(this,AddImage);_this=_super.call(this,props);_this.handleChange=function(e,stateName){// sets e.target.value to whatever state is named\n_this.setState(_defineProperty({},stateName,e.target.value));};_this.handleToggleCapture=function(){var capture=!_this.state.capture;_this.setState({capture:capture});};_this.toBase64=function(file){return new Promise(function(resolve,reject){var reader=new FileReader();reader.readAsDataURL(file);reader.onload=function(){return resolve(reader.result);};reader.onerror=function(error){return reject(error);};});};_this.handleImgur=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,fileBase64,response,addResponse;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(_this.state.imgurBtn===IMGUR_BUTTON)){_context.next=23;break;}// change the button state and then api call \n_this.setState({imgurBtn:IMGUR_LOADING});_context.prev=2;file=e.target.files[0];_context.next=6;return _this.toBase64(file);case 6:fileBase64=_context.sent;_context.next=9;return imgurImage({base64:fileBase64.split(',')[1],name:file.name});case 9:response=_context.sent;console.log(response);_context.next=13;return addImage(_this.props.entryID,response.link);case 13:addResponse=_context.sent;console.log(addResponse);_this.setState({errMsg:'Imgur Upload Successful',imgurBtn:IMGUR_BUTTON,inputURL:''});_this.props.entryReset();_context.next=23;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](2);console.log(_context.t0.message);_this.setState({errMsg:_context.t0.message,imgurBtn:IMGUR_BUTTON});case 23:case\"end\":return _context.stop();}}},_callee,null,[[2,19]]);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handleAddImage=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return addImage(_this.props.entryID,_this.state.inputURL);case 3:response=_context2.sent;console.log(response);_context2.next=11;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0.message);_this.setState({errMsg:_context2.t0.message});case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));_this.state={inputURL:'',errMsg:'',imgurBtn:IMGUR_BUTTON,camFile:null,capture:false};return _this;}_createClass(AddImage,[{key:\"render\",value:function render(){var _this2=this;var captureOption={};if(this.state.capture){captureOption.capture=\"camera\";}return/*#__PURE__*/React.createElement(\"div\",{className:\"AddImage\"},/*#__PURE__*/React.createElement(\"section\",null,/*#__PURE__*/React.createElement(\"h3\",null,this.state.imgurBtn),this.state.errMsg?/*#__PURE__*/React.createElement(\"h4\",null,this.state.errMsg):null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"inputFile\"},\"From Files Or Camera\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ToggleSwitch,{isOn:this.state.capture,onClick:this.handleToggleCapture}),\" \\xA0\",this.state.capture?'From Camera':'From File'),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",Object.assign({type:\"file\",accept:\"image/*\"},captureOption,{onChange:this.handleImgur,name:\"inputFile\"})),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"inputURL\"},\"Enter Or Edit Image URL\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",value:this.state.inputURL,onChange:function onChange(e){return _this2.handleChange(e,'inputURL');}}),this.state.inputURL?/*#__PURE__*/React.createElement(\"button\",{onClick:this.handleAddImage},\"Add Image URL To Entry\"):null));}}]);return AddImage;}(Component);export{AddImage as default};","map":{"version":3,"sources":["/Users/bowserhsu/Documents/React/eitri-site-journal/client/src/components/Entries/AddImage.jsx"],"names":["React","Component","addImage","imgurImage","ToggleSwitch","IMGUR_BUTTON","IMGUR_LOADING","AddImage","props","handleChange","e","stateName","setState","target","value","handleToggleCapture","capture","state","toBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","handleImgur","imgurBtn","files","fileBase64","base64","split","name","response","console","log","entryID","link","addResponse","errMsg","inputURL","entryReset","message","handleAddImage","camFile","captureOption"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { addImage, imgurImage } from '../../services/apiCalls'\nimport ToggleSwitch from './ToggleSwitch'\n\nconst IMGUR_BUTTON = 'Upload Using Imgur Or Image URL'\nconst IMGUR_LOADING = 'Uploading...'\n\nexport default class AddImage extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      inputURL: '',\n      errMsg: '',\n      imgurBtn: IMGUR_BUTTON,\n      camFile: null,\n      capture: false \n    }\n  }\n\n  handleChange = (e, stateName) => {\n    // sets e.target.value to whatever state is named\n    this.setState({\n      [stateName]: e.target.value \n    })\n  }\n\n  handleToggleCapture = () => {\n    const capture = !this.state.capture \n    this.setState({\n      capture \n    })\n  }\n\n  // convert file to base64 \n  // from: https://stackoverflow.com/questions/36280818/how-to-convert-file-to-base64-in-javascript\n  toBase64 = file => new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = error => reject(error);\n  });\n\n  handleImgur = async (e) => {\n    if (this.state.imgurBtn === IMGUR_BUTTON) {\n      // change the button state and then api call \n      this.setState({\n        imgurBtn: IMGUR_LOADING \n      })\n      try {\n\n        const file = e.target.files[0]\n        const fileBase64 = await this.toBase64(file)\n\n        const response = await imgurImage({\n          base64: fileBase64.split(',')[1],\n          name: file.name \n        })\n\n        console.log(response)\n\n        const addResponse = await addImage(this.props.entryID, response.link)\n\n        console.log(addResponse)\n\n        this.setState({\n          errMsg: 'Imgur Upload Successful',\n          imgurBtn: IMGUR_BUTTON,\n          inputURL: ''\n        })\n\n        this.props.entryReset()\n      } catch (error) {\n        console.log(error.message)\n        this.setState({\n          errMsg: error.message,\n          imgurBtn: IMGUR_BUTTON\n        })\n      }\n    }\n  }\n\n  handleAddImage = async () => {\n    try {\n      const response = await addImage(this.props.entryID, this.state.inputURL)\n\n      console.log(response) \n\n    } catch (error) {\n        console.log(error.message)\n        this.setState({\n          errMsg: error.message\n        })\n      }\n  }\n\n  render() {\n    let captureOption = {}\n    if (this.state.capture) {\n      captureOption.capture = \"camera\"\n    }\n    return (\n      <div className=\"AddImage\">\n        <section>\n        <h3>{this.state.imgurBtn}</h3>\n\n        {\n          this.state.errMsg ? <h4>{this.state.errMsg}</h4> : null \n        }\n\n        <label htmlFor=\"inputFile\">From Files Or Camera</label>\n        <div>\n          <ToggleSwitch isOn={this.state.capture} onClick={this.handleToggleCapture} /> &nbsp;\n          {this.state.capture ? 'From Camera' : 'From File'}\n        </div>\n         \n        <br/>\n        <input type=\"file\" accept=\"image/*\" {...captureOption} onChange={this.handleImgur} name=\"inputFile\" />\n\n        <br/>\n        <label htmlFor=\"inputURL\">Enter Or Edit Image URL</label>\n        <input \n          type=\"text\"\n          value={this.state.inputURL}\n          onChange={e => this.handleChange(e, 'inputURL')}\n        />\n        \n        {\n          this.state.inputURL ? <button onClick={this.handleAddImage}>Add Image URL To Entry</button> : null \n        }\n        </section>\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}